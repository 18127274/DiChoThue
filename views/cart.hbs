<script src="../javascripts/api.js"></script>
<script type="text/javascript" src="../javascripts/booking.js"> </script>
<script type="text/javascript" src="../javascripts/cart.js"> </script>
<script type="text/javascript" src="../javascripts/nc_service.js"> </script>
<link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
<link rel="stylesheet" type="text/css" href="/stylesheets/stylebutton.css" />
<link rel="stylesheet" type="text/css" href="/stylesheets/styles2.css" />
<img class="card-img" src="/Header.png" alt="..." />




<!--
 Contact Block -->

{{!-- còn cái phần này là phần giao diện chính của cart khi nào dùng thì mở comment ra là dc --}}
<!-- cart-->
<section id="cart" class="  bg-white">
    <div class="container py-5">


        <div class="row g-5">
            {{!-- phan gio hang --}}


            {{!-- đang cấn đoạn này --}}


            {{!-- fill infor listcard --}}





            <div class="col-md-7 col-lg-8">

                <h4 class="mb-3">Billing address</h4>


                <div class="col-md-5 col-lg-4 order-md-last">

                    <h4 class="d-flex justify-content-between align-items-center mb-3">
                        <span class="text-primary">Your cart</span>
                        <span class="badge bg-primary rounded-pill"></span>
                    </h4>
                    <ul class="list-group mb-3">
                        <table class="table table-bordered" id="myTable" width="1000%" height="1000%" cellspacing="0">
                            <thead>
                                <tr>
                                    <th hidden>ID</th>


                                    <th>Tên sản phẩm</th>
                                    <th>Giá tiền</th>
                                    <th>Số lượng</th>
                                    <th>Tổng tiền</th>
                                    <th>Xóa đơn hàng</th>
                                </tr>
                            </thead>

                            <tbody id="data_cart">




                            </tbody>

                        </table>


                    </ul>
                </div>


                <form id="add1">

                    <input type="submit" class="w-45 btn btn-primary" value="Payment">
                </form>




                <script>

                    function Update_cart() {

                        var html = "<input type=\"button\" value=\"x\" onclick=\"deleteRow(this)\">";

                        var ele = document.getElementById('data_cart');

                        var id_kh = localStorage.getItem("senddata_login");
                        id_kh = JSON.parse(id_kh);


                        view_cartof_customer(id_kh[0].id, (result) => {
                            /*id_service_arr = id_service_arr.split(',');*/


                            for (let i = 0; i < result.dsgioHang.length; i++) {

                                var giatien = result.dsgioHang[i].tongChiTiet / result.dsgioHang[i].chitietgh.sl;


                                ele.innerHTML = ele.innerHTML + "<tr>" +
                                    "<td hidden>" + result.dsgioHang[i].chitietgh.id + "</td>" +
                                    "<td>" + result.dsgioHang[i].tenSP + "</td>" +
                                    "<td>" + giatien + "</td>" +
                                    "<td>" + result.dsgioHang[i].chitietgh.sl + "</td>" +
                                    "<td>" + result.dsgioHang[i].tongChiTiet + "</td>" +
                                    "<td>" + html + "</td></tr>";


                            }

                            ele.innerHTML = ele.innerHTML + "<tr>" +
                                "<td>" + "Tổng hóa đơn" + "</td>" +
                                "<td>" + " " + "</td>" +
                                "<td>" + " " + "</td>" +
                                "<td>" + result.giohang.tongTien + "</td>" +
                                "</tr>";


                        })
                        /*------add_booking("12-09-2021", "23:00", "1", "Le thi", "1234567890", "abc@gmail.com", 260000, "3", "1");--------*/

                    }
                    Update_cart();
                </script>

                <script type='text/x-handlebars-template' id='emp-table'></script>
                <script type='text/x-handlebars-template' id='service-table'></script>
                <script type='text/x-handlebars-template' id='booking-table'></script>


                {{!-- function delete row --}}
                <script>

                    /*var id_service = localStorage.getItem("senddata");*/
                    function deleteRow(r) {

                        var c = confirm("Are you sure delete?");
                        if (c == true) {
                            var i = r.parentNode.parentNode.rowIndex;
                            var j = document.getElementsByTagName("tr")[i];
                            var index = j.childNodes[0].innerHTML;

                            console.log(index);
                            console.log(i);
                            document.getElementById("myTable").deleteRow(i);

                            delete_service_ofcart(index);

                        } else {

                        }
                        var myobj = document.getElementById("data_cart").innerHTML = "";
                        var myobj = document.getElementById("data_cart");
                        console.log(myobj);
                        document.getElementById("data_cart").innerHTML = "";

                        Update_cart();
                    }
                </script>



                <script>
                    var form = document.getElementById('add1');
                    form.addEventListener('submit', function (event) {
                        event.preventDefault();

                        var myArrayFromLocalStorage2 = localStorage.getItem('send_arr_service')
                        var id_service_arr2 = JSON.parse(myArrayFromLocalStorage2)
                        console.log(id_service_arr2);

                        var total_price1 = localStorage.getItem("total_price_local");
                        var id_emp = document.getElementById('allemp').value;

                        var date = formatDate(document.getElementById('date').value);
                        var time = document.getElementById('time').value;
                        var Name = document.getElementById('Name').value;
                        var email = document.getElementById('email').value;
                        var phone = document.getElementById('phone').value;
                        console.log(id_service_arr2);

                        console.log(id_emp);
                        console.log(date);
                        console.log(time);
                        console.log(Name);
                        console.log(email);
                        console.log(total_price1);
                        console.log(phone);
                        add_booking(date, time, Name, phone, email, total_price1, id_emp, id_service_arr2);


                    });
                </script>
                {{!-- doc cac du lieu va goi api add booking --}}

            </div>
        </div>



    </div>
</section>


{{!-- Cái phần này là cái form để demo thêm 1 service thông qua điền form rồi click nút add_service sẽ gọi api
add_service --}}